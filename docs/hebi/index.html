<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>hebi API documentation</title>
<meta name="description" content="&lt;div align=&#34;center&#34;&gt; â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>hebi</code></h1>
</header>
<section id="section-intro">
<div align="center">
<img
src="https://raw.githubusercontent.com/OpShin/hebi/master/hebi.png" width="240" />
<h1 style="text-align: center;">hebi</h1></br>
<a href="https://app.travis-ci.com/OpShin/hebi"><img alt="Build Status" src="https://app.travis-ci.com/OpShin/hebi.svg?branch=master"/></a>
<a href="https://pypi.org/project/hebi/"><img alt="PyPI version" src="https://badge.fury.io/py/hebi.svg"/></a>
<img alt="PyPI - Python Version" src="https://img.shields.io/pypi/pyversions/hebi.svg" />
<a href="https://pypi.org/project/hebi/"><img alt="PyPI - Status" src="https://img.shields.io/pypi/status/hebi.svg" /></a>
<a href="https://coveralls.io/github/OpShin/hebi?branch=master"><img alt="Coverage Status" src="https://coveralls.io/repos/github/OpShin/hebi/badge.svg?branch=master" /></a>
</div>
<blockquote>
<p>You are building what you want. Why not also build <strong>how</strong> you want?</p>
</blockquote>
<p>This is an implementation of smart contracts for Cardano which are written in a strict subset of valid Python.
The general philosophy of this project is to write a compiler that
ensure the following:</p>
<p>If the program compiles then:</p>
<ol>
<li>it is a valid Python program</li>
<li>the output running it with python is the same as running it on-chain.</li>
</ol>
<h3 id="why-hebi">Why hebi?</h3>
<ul>
<li>100% valid Python. Leverage the existing tool stack for Python, syntax highlighting, linting, debugging, unit-testing, <a href="https://hypothesis.readthedocs.io/">property-based testing</a>, <a href="https://github.com/marcoeilers/nagini">verification</a></li>
<li>Intuitive. Just like Python.</li>
<li>Flexible. Imperative, functional, the way you want it.</li>
<li>Efficient &amp; Secure. Static type inference ensures strict typing and optimized code</li>
</ul>
<p>Note this is the sister project of <a href="https://github.com/ImperatorLang/eopsin">eopsin</a>.
It uses an even more restricted subset of python (for example no if &amp; while).
The benefit is that the resulting code is greatly reduced in size and cpu/memory consumption.</p>
<p>Eopsin is more comfortable to use than hebi.
If you want to start building, write your contract in eopsin first.
Then, after everything works to your pleasing, try to port to hebi and enjoy the performance gains.</p>
<h3 id="getting-started">Getting Started</h3>
<h4 id="eopsin-pioneer-program">Eopsin Pioneer Program</h4>
<p>Check out the <a href="https://github.com/OpShin/eopsin-pioneer-program">eopsin-pioneer-program</a> for a host of educational example contracts, test cases and off-chain code.</p>
<h4 id="example-repository">Example repository</h4>
<p>Check out the <a href="https://github.com/OpShin/eopsin-example">eopsin-example</a> repository for a quick start in setting up a development environment
and compiling some sample contracts yourself.</p>
<p>You can replace the contracts in your local copy of the repository with code from the
<code>examples</code> section here to start exploring different contracts.</p>
<h4 id="developer-community-and-questions">Developer Community and Questions</h4>
<p>The eopsin repository contains a discussions page.
Feel free to open up a new discussion with questions regarding development using hebi and using certain features.
Others may be able to help you and will also benefit from the previously shared questions.</p>
<p>Check out the community <a href="https://github.com/OpShin/eopsin/discussions">here</a></p>
<p>You can also chat with other developers <a href="https://discord.gg/2ETSZnQQH9">in the welcoming discord
community</a> of OpShin</p>
<h4 id="installation">Installation</h4>
<p>Install Python 3.8. Then run</p>
<pre><code class="language-bash">python3.8 -m pip install hebi
</code></pre>
<h4 id="writing-a-smart-contract">Writing a Smart Contract</h4>
<p>A short non-complete introduction in starting to write smart contracts follows.</p>
<ol>
<li>Make sure you understand EUTxOs, Addresses, Validators etc on Cardano. <a href="https://aiken-lang.org/fundamentals/eutxo">There is a wonderful crashcourse by @KtorZ</a>. The contract will work on these concepts</li>
<li>Make sure you understand python. Eopsin works like python and uses python. There are tons of tutorials for python, choose what suits you best.</li>
<li>Make sure your contract is valid python and the types check out. Write simple contracts first and run them using <code><a title="hebi" href="#hebi">hebi</a> eval</code> to get a feeling for how they work.</li>
<li>Make sure your contract is valid hebi code. Run <code><a title="hebi" href="#hebi">hebi</a> compile</code> and look at the compiler erros for guidance along what works and doesn't work and why.</li>
<li>Dig into the <a href="https://github.com/OpShin/hebi/tree/master/examples"><code>examples</code></a> to understand common patterns. Check out the <a href="https://opshin.github.io/hebi/prelude.html"><code>prelude</code></a> for understanding how the Script Context is structured and how complex datums are defined.</li>
<li>Check out the <a href="https://github.com/OpShin/eopsin-example">sample repository</a> to find a sample setup for developing your own contract.</li>
</ol>
<p>In summary, a smart contract in hebi is defined by the function <code>validator</code> in your contract file.
The function validates that a specific value can be spent, minted, burned, withdrawn etc, depending
on where it is invoked/used as a credential.
If the function fails (i.e. raises an error of any kind such as a <code>KeyError</code> or <code>AssertionError</code>)
the validation is denied, and the funds can not be spent, minted, burned etc.</p>
<blockquote>
<p>There is a subtle difference here in comparison to most other Smart Contract languages.
In hebi a validator may return anything (in particular also <code>False</code>) - as long as it does not fail, the execution is considered valid.
This is more similar to how contracts in Solidity always pass, unless they run out of gas or hit an error.
So make sure to <code>assert</code> what you want to ensure to hold for validation!</p>
</blockquote>
<p>A simple contract called the "Gift Contract" verifies that only specific wallets can withdraw money.
They are authenticated by a signature.
If you don't understand what a pubkeyhash is and how this validates anything, check out <a href="https://aiken-lang.org/fundamentals/eutxo">this gentle introduction into Cardanos EUTxO</a>.
Also see the <a href="https://pycardano.readthedocs.io/en/latest/guides/plutus.html">tutorial by <code>pycardano</code></a> for explanations on what each of the parameters to the validator means
and how to build transactions with the contract.</p>
<pre><code class="language-python3">from hebi.prelude import *

@dataclass()
class CancelDatum(PlutusData):
    pubkeyhash: bytes


def validator(datum: CancelDatum, redeemer: None, context: ScriptContext) -&gt; None:
    assert datum.pubkeyhash in context.tx_info.signatories, &quot;Required signature missing&quot;
</code></pre>
<p>All contracts written in hebi are 100% valid python.
Minting policies expect only a redeemer and script context as argument.
Check out the <a href="https://github.com/OpShin/hebi/blob/master/ARCHITECTURE.md#minting-policy---spending-validator-double-function">Architecture guide</a>
for details on how to write double functioning contracts.
The <a href="https://github.com/OpShin/hebi/blob/master/examples"><code>examples</code></a> folder contains more examples.
Also check out the <a href="https://github.com/OpShin/eopsin-pioneer-program">eopsin-pioneer-program</a>
and <a href="https://github.com/OpShin/eopsin-example">eopsin-example</a> repo.</p>
<h3 id="compiling">Compiling</h3>
<p>Write your program in python. You may start with the content of <code>examples</code>.
Arguments to scripts are passed in as Plutus Data objects in JSON notation.</p>
<p>You can run any of the following commands</p>
<pre><code class="language-bash"># Evaluate script in Python - this can be used to make sure there are no obvious errors
hebi eval examples/smart_contracts/assert_sum.py &quot;{\&quot;int\&quot;: 4}&quot; &quot;{\&quot;int\&quot;: 38}&quot; &quot;{\&quot;constructor\&quot;: 0, \&quot;fields\&quot;: []}&quot;

# Compile script to 'uplc', the Cardano Smart Contract assembly
hebi compile examples/smart_contracts/assert_sum.py
</code></pre>
<h3 id="deploying">Deploying</h3>
<p>The deploy process generates all artifacts required for usage with common libraries like <a href="https://github.com/Python-Cardano/pycardano">pycardano</a>, <a href="https://github.com/spacebudz/lucid">lucid</a> and the <a href="https://github.com/input-output-hk/cardano-node">cardano-cli</a>.</p>
<pre><code class="language-bash"># Automatically generate all artifacts needed for using this contract
hebi build examples/smart_contracts/assert_sum.py
</code></pre>
<p>See the <a href="https://pycardano.readthedocs.io/en/latest/guides/plutus.html">tutorial by <code>pycardano</code></a> for explanations how to build transactions with <code>eopsin</code> contracts.
Contracts in hebi are invoked the same, so you can just follow the tutorial there.</p>
<h3 id="the-small-print">The small print</h3>
<p><em>Not every valid python program is a valid smart contract</em>.
Not all language features of python will or can be supported.
The reasons are mainly of practical nature (i.e. we can't infer types when functions like <code>eval</code> are allowed).
Specifically, only a pure subset of python is allowed.
Further, only immutable objects may be generated.</p>
<p>For your program to be accepted, make sure to only make use of language constructs supported by the compiler.
You will be notified of which constructs are not supported when trying to compile.</p>
<h3 id="name">Name</h3>
<p>Hebi is japanese for "snake", which is a play on words on <code>python</code>, the underlying language.</p>
<h3 id="versioning-scheme">Versioning scheme</h3>
<p>Since this project builds on top of eopsin, it has a particular versioning scheme.
The first three numbers indicate the version of <code><a title="hebi" href="#hebi">hebi</a></code> (starting at <code>0.1.0</code>).
Then follows the latest version number of <code>eopsin</code> which was merged into the project (starting at <code>0.9.3</code>).
This is intended to help navigating releases among both packages, where it might be important
that a recent eopsin release is integrated that contains a security patch.</p>
<h2 id="contributing">Contributing</h2>
<h3 id="architecture">Architecture</h3>
<p>This program consists of a few independent components:
1. An aggressive static type inferencer
2. Rewriting tools to simplify complex python expressions
3. A compiler from a subset of python into UPLC</p>
<h3 id="debugging-artefacts">Debugging artefacts</h3>
<p>For debugging purposes, you can also run</p>
<pre><code class="language-bash"># Compile script to 'uplc', and evaluate the script in UPLC (for debugging purposes)
python3 -m hebi eval_uplc examples/smart_contracts/assert_sum.py &quot;{\&quot;int\&quot;: 4}&quot; &quot;{\&quot;int\&quot;: 38}&quot; &quot;{\&quot;constructor\&quot;: 0, \&quot;fields\&quot;: []}&quot;

# Compile script to 'pluto', an intermediate language (for debugging purposes)
python3 -m hebi compile_pluto examples/smart_contracts/assert_sum.py
</code></pre>
<h3 id="sponsoring">Sponsoring</h3>
<p>You can sponsor the development of hebi through GitHub or <a href="https://alpha.teiki.network/projects/opshin">Teiki</a> or just by sending ADA. Drop me a message on social media and let me know what it is for.</p>
<ul>
<li><strong><a href="https://alpha.teiki.network/projects/opshin">Teiki</a></strong> Stake your ada to support OpShin at <a href="https://alpha.teiki.network/projects/opshin">Teiki</a></li>
<li><strong>GitHub</strong> Sponsor the developers of this project through the button "Sponsor" next to them</li>
<li><strong>ADA</strong> Donation in ADA can be submitted to <code>$opshin</code> or <code>addr1qyz3vgd5xxevjy2rvqevz9n7n7dney8n6hqggp23479fm6vwpj9clsvsf85cd4xc59zjztr5zwpummwckmzr2myjwjns74lhmr</code>.</li>
</ul>
<h3 id="supporters">Supporters</h3>
<p><a href="https://github.com/inversion-dev"><img src="https://avatars.githubusercontent.com/u/127298233?s=200&v=4" width="50"></a>
<a href="https://github.com/MuesliSwapTeam/"><img
src="https://avatars.githubusercontent.com/u/91151317?v=4" width="50" /></a>
<a href="https://github.com/AadaFinance/"><img
src="https://avatars.githubusercontent.com/u/89693711?v=4" width="50" /></a></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python
# -*- coding: utf-8 -*-
&#34;&#34;&#34;
.. include:: ../README.md
&#34;&#34;&#34;

import warnings

try:
    from compiler import *
except ImportError as e:
    warnings.warn(ImportWarning(e))

__version__ = &#34;0.1.1.0.9.12&#34;
__author__ = &#34;nielstron&#34;
__author_email__ = &#34;n.muendler@web.de&#34;
__copyright__ = &#34;Copyright (C) 2023 nielstron&#34;
__license__ = &#34;MIT&#34;
__url__ = &#34;https://github.com/imperatorlang/hebi&#34;</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="hebi.compiler" href="compiler.html">hebi.compiler</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.ledger" href="ledger/index.html">hebi.ledger</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.optimize" href="optimize/index.html">hebi.optimize</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.prelude" href="prelude.html">hebi.prelude</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.rewrite" href="rewrite/index.html">hebi.rewrite</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.tests" href="tests/index.html">hebi.tests</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.type_inference" href="type_inference.html">hebi.type_inference</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.typed_ast" href="typed_ast.html">hebi.typed_ast</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="hebi.util" href="util.html">hebi.util</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#why-hebi">Why hebi?</a></li>
<li><a href="#getting-started">Getting Started</a><ul>
<li><a href="#eopsin-pioneer-program">Eopsin Pioneer Program</a></li>
<li><a href="#example-repository">Example repository</a></li>
<li><a href="#developer-community-and-questions">Developer Community and Questions</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#writing-a-smart-contract">Writing a Smart Contract</a></li>
</ul>
</li>
<li><a href="#compiling">Compiling</a></li>
<li><a href="#deploying">Deploying</a></li>
<li><a href="#the-small-print">The small print</a></li>
<li><a href="#name">Name</a></li>
<li><a href="#versioning-scheme">Versioning scheme</a></li>
<li><a href="#contributing">Contributing</a><ul>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#debugging-artefacts">Debugging artefacts</a></li>
<li><a href="#sponsoring">Sponsoring</a></li>
<li><a href="#supporters">Supporters</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="hebi.compiler" href="compiler.html">hebi.compiler</a></code></li>
<li><code><a title="hebi.ledger" href="ledger/index.html">hebi.ledger</a></code></li>
<li><code><a title="hebi.optimize" href="optimize/index.html">hebi.optimize</a></code></li>
<li><code><a title="hebi.prelude" href="prelude.html">hebi.prelude</a></code></li>
<li><code><a title="hebi.rewrite" href="rewrite/index.html">hebi.rewrite</a></code></li>
<li><code><a title="hebi.tests" href="tests/index.html">hebi.tests</a></code></li>
<li><code><a title="hebi.type_inference" href="type_inference.html">hebi.type_inference</a></code></li>
<li><code><a title="hebi.typed_ast" href="typed_ast.html">hebi.typed_ast</a></code></li>
<li><code><a title="hebi.util" href="util.html">hebi.util</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>